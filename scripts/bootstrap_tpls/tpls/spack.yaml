spack:
  include:
  - packages.yaml
  - compilers.yaml
  - config.yaml
  - $SPACK_MANAGER/configs/base/packages.yaml
  definitions:
  - compilers: ['%gcc', '%clang']
  - core:
    - cmake
    - python
    - ninja
    - yaml-cpp
    - netcdf-c ^openmpi@4.0.5
    - hdf5
  specs:
  - matrix:
    - [$core]
    - [$compilers]
  - cuda@11.2%gcc
  - netcdf-c%gcc ^mvapich2
  view:
    default:
      root: $env/view
      projections:
        all: '{compiler.name}/{compiler.version}/{name}/{version}/{hash:8}'
      link_type: symlink
  concretizer:
    unify: false
  packages:
    all:
      target: [x86_64]
      variants: [build_type=Release]
    openmpi:
      variants: [+legacylaunchers fabrics=auto schedulers=auto]
    python:
      variants: [~crypt]
